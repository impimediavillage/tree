rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    
    // Allow public read access for all files. This is generally safe
    // for assets like images, icons, etc., that are meant to be displayed in the app.
    match /{allPaths=**} {
      allow read: if true;
    }

    // Only Super Admins can upload assets for dispensary types (icons, banners).
    // This requires the 'Super Admin' role to be set as a custom claim on the user's auth token.
    match /dispensary-type-assets/{allPaths=**} {
      allow write: if request.auth != null && request.auth.token.role == 'Super Admin';
    }

    // Any authenticated user can upload assets to their own sticker set folder.
    // This rule ensures users can only write to their own directory, identified by their UID.
    match /stickersets/{userId}/{allPaths=**} {
      allow write: if request.auth != null && request.auth.uid == userId;
    }

  }
}
